<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SwapX - DEX</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-gradient: linear-gradient(90deg, #ff9a9e 0%, #fecfef 99%, #fecfef 100%);
            --button-gradient: linear-gradient(135deg, #FF6B6B 0%, #FF8E53 100%);
            --bg-color: #ffffff;
            --card-white: #ffffff;
            --text-dark: #1c1c1e;
            --text-gray: #8e8e93;
            --border-color: #f0f0f0;
            --nav-height: 80px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background-color: var(--bg-color);
            /* 模拟截图中的炫彩背景 */
            background-image: radial-gradient(circle at 0% 0%, #ffdee9 0%, #fff 50%), radial-gradient(circle at 100% 0%, #c2e9fb 0%, #fff 50%);
            background-attachment: fixed;
            color: var(--text-dark);
            padding-bottom: var(--nav-height);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* 顶部 Header */
        .header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }
        .logo { 
            font-size: 20px; 
            font-weight: 800; 
            display: flex; 
            align-items: center; 
            gap: 8px;
        }
        .logo i { color: #FF3B30; }
        /* 左上角连接钱包按钮 */
        .wallet-connect-btn {
            padding: 8px 16px;
            border-radius: 16px;
            border: none;
            font-size: 14px;
            font-weight: 700;
            color: white;
            cursor: pointer;
            transition: 0.3s;
            background: var(--button-gradient);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .wallet-connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
        }

        /* 主交易卡片 */
        .swap-container {
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .swap-card {
            background: var(--card-white);
            border-radius: 24px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            position: relative;
        }

        .input-box {
            background: #f9f9f9;
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 5px;
        }

        .label-row {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 10px;
        }

        .input-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .amount-input {
            background: transparent;
            border: none;
            font-size: 28px;
            font-weight: 600;
            color: var(--text-dark);
            width: 50%;
            outline: none;
        }
        .amount-input::placeholder { color: #dcdcdc; }

        .token-selector {
            background: white;
            padding: 6px 10px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            cursor: pointer;
            min-width: 100px;
            justify-content: space-between;
        }
        .token-selector img { width: 24px; height: 24px; border-radius: 50%; }
        .token-selector span { font-weight: 600; font-size: 16px; }

        .balance-row {
            display: flex;
            justify-content: flex-end;
            font-size: 12px;
            color: var(--text-gray);
            margin-top: 8px;
            gap: 5px;
        }
        .max-btn { color: #FF3B30; font-weight: 600; cursor: pointer; }

        /* 交换按钮 (箭头) */
        .swap-arrow-container {
            height: 0;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }
        .swap-arrow-btn {
            background: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            color: var(--text-dark);
            border: 3px solid white; /* Create gap effect */
        }

        /* 底部操作按钮 */
        .action-btn {
            width: 100%;
            padding: 16px;
            border-radius: 16px;
            border: none;
            font-size: 18px;
            font-weight: 700;
            color: white;
            cursor: pointer;
            margin-top: 15px;
            transition: 0.3s;
        }
        
        .btn-active {
            background: var(--button-gradient);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }
        
        .btn-disabled {
            background: #e0e0e0; /* 默认灰色 */
            color: #999;
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-warning {
            background: #ffd54f; /* 余额不足黄 */
            color: #5d4037;
        }

        /* 信息栏 */
        .info-card {
            margin-top: 20px;
            background: white;
            border-radius: 16px;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* 底部导航栏 */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; height: var(--nav-height);
            background: white; display: flex; justify-content: space-around; align-items: center;
            border-top: 1px solid var(--border-color); z-index: 99;
        }
        .nav-item { display: flex; flex-direction: column; align-items: center; color: var(--text-gray); font-size: 10px; text-decoration: none; }
        .nav-item i { font-size: 22px; margin-bottom: 4px; }
        .nav-item.active { color: var(--text-dark); }

        /* ==================== 弹窗样式 ==================== */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.4);
            z-index: 200; display: none;
            align-items: flex-end;
        }
        .modal-overlay.active { display: flex; animation: fadeIn 0.2s; }

        .modal-content {
            background: white;
            width: 100%;
            height: 70vh;
            border-radius: 24px 24px 0 0;
            display: flex;
            flex-direction: column;
            animation: slideUp 0.3s;
        }

        .modal-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #f0f0f0;
        }
        .modal-title { font-size: 16px; font-weight: 700; }
        .close-btn { font-size: 20px; cursor: pointer; color: #999; }

        .modal-body {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* 左侧：热门代币 */
        .token-column {
            flex: 2;
            overflow-y: auto;
            padding: 10px;
        }
        .token-item {
            display: flex;
            align-items: center;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
        }
        .token-item:hover { background: #f5f5f5; }
        .token-item img { width: 32px; height: 32px; border-radius: 50%; margin-right: 12px; }
        .token-text h4 { font-size: 16px; margin-bottom: 2px; }
        .token-text p { font-size: 12px; color: #999; }

        /* 右侧：链选择 */
        .chain-column {
            flex: 1;
            background: #f9f9f9;
            border-left: 1px solid #eee;
            overflow-y: auto;
            padding: 10px 0;
        }
        .chain-item {
            padding: 15px 10px;
            display: flex;
            align-items: center;
            font-size: 13px;
            color: #666;
            cursor: pointer;
            position: relative;
        }
        .chain-item.active { background: white; color: var(--text-dark); font-weight: 600; }
        .chain-item.active::before {
            content: ''; position: absolute; left: 0; top: 15%; height: 70%; width: 3px; background: #FF3B30;
        }
        .chain-item img { width: 20px; margin-right: 8px; border-radius: 50%; }

        /* ==================== 购买和卖出页面 ==================== */
        .buy-sell-container {
            display: none;
        }
        .buy-sell-container.active {
            display: flex;
            flex-direction: column;
        }

        .buy-form, .sell-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .form-group {
            background: #f9f9f9;
            border-radius: 16px;
            padding: 15px;
        }

        .form-group-label {
            font-size: 14px;
            color: var(--text-gray);
            margin-bottom: 10px;
            display: block;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: none;
            background: white;
            border-radius: 12px;
            font-size: 16px;
            outline: none;
        }

        .form-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .form-row .form-group {
            flex: 1;
            margin: 0;
        }

        .token-select-btn, .payment-method-btn {
            background: white;
            border: 1px solid #e0e0e0;
            padding: 12px 15px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            width: 100%;
            margin-top: 8px;
        }

        .token-select-btn:hover, .payment-method-btn:hover {
            background: #f5f5f5;
        }

        /* 滑点设置 */
        .slippage-menu {
            position: fixed;
            top: 0;
            right: 0;
            width: 280px;
            height: 100%;
            background: white;
            z-index: 500;
            transform: translateX(100%);
            transition: transform 0.3s;
            box-shadow: -5px 0 15px rgba(0,0,0,0.1);
            overflow-y: auto;
            padding: 20px;
        }

        .slippage-menu.active {
            transform: translateX(0);
        }

        .slippage-menu-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .slippage-option {
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slippage-option input[type="radio"] {
            accent-color: #FF3B30;
        }

        .slippage-option label {
            flex: 1;
            cursor: pointer;
        }

        .slippage-custom {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .slippage-custom input {
            width: 60px;
            padding: 6px 8px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 12px;
        }

        .slippage-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            z-index: 499;
            display: none;
        }

        .slippage-overlay.active {
            display: block;
        }

        /* 钱包选择项样式 */
        .modal-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
        }
        .close-modal {
            position: absolute;
            right: 0; top: 0;
            color: #999;
            cursor: pointer;
            font-size: 20px;
        }
        .option-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            font-size: 15px;
            font-weight: 500;
        }
        .option-item:last-child { border-bottom: none; }
        .option-item img { width: 24px; margin-right: 15px; }
        .option-item i { width: 24px; margin-right: 15px; text-align: center; font-size: 18px; color: #333; }
        .option-item:active { background: #f9f9f9; }

        @keyframes fadeIn { from {opacity:0} to {opacity:1} }
        @keyframes slideUp { from {transform:translateY(100%)} to {transform:translateY(0)} }

        /* ==================== 移动端响应式设计 ==================== */
        @media (max-width: 768px) {
            /* 流动性池控制栏响应式 */
            .liquidity-controls {
                flex-direction: column;
                gap: 12px;
                align-items: stretch !important;
            }

            .liquidity-controls > div:first-child {
                gap: 8px;
            }

            .liquidity-controls > div:nth-child(2) {
                flex-direction: column;
                gap: 8px;
                align-items: stretch !important;
                justify-content: stretch !important;
            }

            .liquidity-controls > button {
                width: 100%;
            }

            .liquidity-controls button {
                padding: 8px 12px;
                font-size: 12px;
            }

            .liquidity-controls input {
                width: 100% !important;
            }

            .liquidity-controls label {
                width: 100% !important;
            }

            /* 流动性池统计卡片响应式 */
            .liquidity-stats {
                grid-template-columns: 1fr !important;
            }

            .liquidity-stats > div {
                padding: 16px !important;
            }

            .liquidity-stats > div div:first-child {
                font-size: 11px !important;
            }

            .liquidity-stats > div div:nth-child(2) {
                font-size: 18px !important;
            }

            /* 流动性池列表表头响应式 */
            .liquidity-header {
                grid-template-columns: 1.5fr 1fr 1fr !important;
                gap: 8px !important;
                font-size: 11px !important;
                padding: 8px 0 !important;
            }

            .liquidity-header > div:nth-child(4),
            .liquidity-header > div:nth-child(5) {
                display: none;
            }

            /* 流动性池列表项响应式 */
            .liquidity-item {
                grid-template-columns: 1.5fr 1fr 1fr !important;
                gap: 8px !important;
                padding: 10px 0 !important;
                font-size: 12px !important;
            }

            .liquidity-item > div:nth-child(1) {
                display: flex !important;
                align-items: center !important;
                gap: 6px !important;
                min-width: 0;
            }

            .liquidity-item > div:nth-child(1) img:first-child {
                width: 28px !important;
                height: 28px !important;
                flex-shrink: 0;
            }

            .liquidity-item > div:nth-child(1) div {
                display: flex !important;
                align-items: center !important;
                gap: 3px !important;
                overflow: hidden;
                flex-wrap: wrap;
                min-width: 0;
            }

            .liquidity-item > div:nth-child(1) span:nth-child(1) {
                font-size: 12px !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .liquidity-item > div:nth-child(1) span:nth-child(3) {
                font-size: 12px !important;
                white-space: nowrap;
            }

            .liquidity-item > div:nth-child(1) img:last-child {
                width: 24px !important;
                height: 24px !important;
                margin-left: 0 !important;
                flex-shrink: 0;
            }

            .liquidity-item > div:nth-child(1) span:nth-child(5) {
                font-size: 9px !important;
                padding: 1px 4px !important;
                margin-left: 4px !important;
                flex-shrink: 0;
            }

            /* 隐藏移动端不需要的列 */
            .liquidity-item > div:nth-child(2),
            .liquidity-item > div:nth-child(4),
            .liquidity-item > div:nth-child(5) {
                display: none;
            }

            /* 调整第三列（TVL）为可见 */
            .liquidity-item > div:nth-child(3) {
                display: block !important;
                font-weight: 600 !important;
                font-size: 12px !important;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }
        }

    </style>
</head>
<body>

    <div class="header">
        <button class="wallet-connect-btn" onclick="connectWallet()">
            <i class="fas fa-wallet"></i> 连接钱包
        </button>
        <div class="logo">
            <i class="fas fa-layer-group"></i> SwapX
        </div>
    </div>

    <div class="swap-container">
        <!-- 主导航标签 -->
        <div style="display:flex; justify-content:space-around; margin-bottom:15px; border-bottom:1px solid #e0e0e0; padding-bottom:10px;">
            <div style="font-weight:700; border-bottom:2px solid #000; padding-bottom:8px; cursor:pointer; flex:1; text-align:center;" onclick="switchMode('swap')">兑换</div>
            <div style="color:#999; cursor:pointer; flex:1; text-align:center;" onclick="switchMode('liquidity')">流动性池</div>
            <div style="color:#999; cursor:pointer; flex:1; text-align:center;" onclick="switchMode('otc')">OTC</div>
            <i class="fas fa-sliders-h" style="color:#999; cursor:pointer; font-size:18px; flex:0; padding-top:8px;" onclick="toggleSlippageMenu()"></i>
        </div>
        
        <div class="swap-card" id="swapMode">
            <div class="input-box">
                <div class="label-row">
                    <span style="cursor:pointer; font-weight:600;" onclick="openChainModal('from')">
                        从 <i class="fab fa-ethereum" style="color:#627EEA"></i> <span id="fromChainText">Ethereum</span>
                        <i class="fas fa-chevron-down" style="font-size:10px; margin-left:5px;"></i>
                    </span>
                </div>
                <div class="input-row">
                    <input type="number" class="amount-input" id="payInput" placeholder="0.00" oninput="calculateOutput()">
                    <div class="token-selector" onclick="openTokenModal('pay')">
                        <div style="display:flex; align-items:center;">
                            <img src="https://cryptologos.cc/logos/ethereum-eth-logo.png" id="payTokenIcon">
                            <span id="payTokenSymbol" style="margin-left:5px;">ETH</span>
                        </div>
                        <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                    </div>
                </div>
                <div class="balance-row">
                    <span>余额: <span id="payBalance">1.50</span></span>
                    <span class="max-btn" onclick="setMax()">最大</span>
                </div>
            </div>

            <div class="swap-arrow-container">
                <div class="swap-arrow-btn" onclick="switchDirection()">
                    <i class="fas fa-arrow-down"></i>
                </div>
            </div>

            <div class="input-box" style="margin-top:-18px; padding-top:25px;">
                <div class="label-row">
                    <span style="cursor:pointer; font-weight:600;" onclick="openChainModal('to')">
                        到 <i class="fab fa-ethereum" style="color:#627EEA"></i> <span id="toChainText">Ethereum</span>
                        <i class="fas fa-chevron-down" style="font-size:10px; margin-left:5px;"></i>
                    </span>
                </div>
                <div class="input-row">
                    <input type="text" class="amount-input" id="receiveInput" placeholder="0.00" readonly>
                    <div class="token-selector" onclick="openTokenModal('receive')">
                        <div style="display:flex; align-items:center;">
                            <img src="https://cryptologos.cc/logos/tether-usdt-logo.png" id="receiveTokenIcon">
                            <span id="receiveTokenSymbol" style="margin-left:5px;">USDT</span>
                        </div>
                        <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                    </div>
                </div>
                <div class="balance-row">
                    <span>余额: <span id="receiveBalance">0.00</span></span>
                </div>
            </div>

            <button class="action-btn btn-active" id="mainBtn" onclick="executeSwap()">输入金额</button>
        </div>
        
        <!-- 流动性池页面 -->
        <div class="buy-sell-container" id="liquidityMode">
            <div class="swap-card">
                <!-- 统计数据 -->
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; margin-bottom:20px;" class="liquidity-stats">
                    <div style="background:linear-gradient(135deg, #ffdee9 0%, #fff 100%); border-radius:16px; padding:20px;">
                        <div style="font-size:12px; color:#999; margin-bottom:8px;">总交易量</div>
                        <div style="font-size:24px; font-weight:700; color:#000;">$923,376,028.06</div>
                        <div style="font-size:12px; color:#999; margin-top:8px;">
                           
                        </div>
                    </div>
                    <div style="background:linear-gradient(135deg, #c2e9fb 0%, #fff 100%); border-radius:16px; padding:20px;">
                        <div style="font-size:12px; color:#999; margin-bottom:8px;">总锁仓量</div>
                        <div style="font-size:24px; font-weight:700; color:#000;">$4,881,762.67</div>
                        <div style="font-size:12px; color:#999; margin-top:8px;">
                 
                        </div>
                    </div>
                </div>

                <!-- 控制栏 -->
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;" class="liquidity-controls">
                    <div style="display:flex; gap:10px;">
                        <button id="v2Btn" onclick="switchLiquidityVersion('v2')" style="padding:8px 16px; background:#000; color:white; border:none; border-radius:20px; font-weight:600; cursor:pointer;">V2</button>
                        <button id="v3Btn" onclick="switchLiquidityVersion('v3')" style="padding:8px 16px; background:white; color:#000; border:1px solid #e0e0e0; border-radius:20px; font-weight:600; cursor:pointer;">V3</button>
                    </div>
                    <div style="display:flex; gap:10px; align-items:center; flex:1; justify-content:flex-end;">
                        <label style="display:flex; align-items:center; gap:8px; cursor:pointer; background:white; padding:8px 14px; border-radius:20px; border:1px solid #e0e0e0;">
                            <input type="checkbox" id="myPositionsCheckbox" onchange="toggleMyPositions()" style="width:16px; height:16px;">
                            <span style="font-size:14px; color:#666;">我的持仓</span>
                        </label>
                        <input type="text" id="liquiditySearch" placeholder="搜索..." oninput="searchLiquidity()" style="padding:8px 12px; background:#f5f5f5; border:none; border-radius:8px; width:140px; outline:none;">
                    </div>
                    <button onclick="openLiquidityCreator()" style="padding:10px 20px; background:var(--button-gradient); color:white; border:none; border-radius:12px; font-weight:600; cursor:pointer; margin-left:10px;">+ 创建</button>
                </div>

                <!-- 列表头 -->
                <div style="display:grid; grid-template-columns:2fr 1fr 1fr 1fr 1fr; gap:15px; padding:10px 0; border-bottom:1px solid #e0e0e0; font-size:12px; color:#999; font-weight:600;" class="liquidity-header">
                    <div>流动性池</div>
                    <div>合约</div>
                    <div>TVL</div>
                    <div>一天交易量</div>
                    <div>年化利率</div>
                </div>

                <!-- 流动性池列表 -->
                <div id="liquidityListContainer" style="display:flex; flex-direction:column; gap:12px; margin-top:10px; max-height:450px; overflow-y:auto;">
                    <!-- 动态生成的流动性池列表 -->
                </div>
            </div>
        </div>

        <!-- OTC页面 -->
        <div class="buy-sell-container" id="otcMode">
            <div class="swap-card">
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <button class="action-btn" id="buyBtn" onclick="switchOTCMode('buy')" style="flex:1; background:#FF6B6B; color:white; border:none; border-radius:12px;">购买</button>
                    <button class="action-btn" id="sellBtn" onclick="switchOTCMode('sell')" style="flex:1; background:#f0f0f0; color:#000; border:none; border-radius:12px;">卖出</button>
                </div>

                <div class="buy-form" id="buyFormContent">
                    <div class="form-group">
                        <label class="form-group-label">选择代币</label>
                        <div class="token-select-btn" onclick="openBuyTokenModal()">
                            <div style="display:flex; align-items:center; gap:8px;">
                                <img id="buyTokenIcon" src="https://cryptologos.cc/logos/tether-usdt-logo.png" style="width:24px; height:24px; border-radius:50%;">
                                <span id="buyTokenName">USDT</span>
                            </div>
                            <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">购买金额</label>
                        <input type="number" class="form-input" id="buyAmount" placeholder="输入购买数量" oninput="calculateBuyUSD()">
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">USD金额</label>
                        <input type="text" class="form-input" id="buyUSD" placeholder="0.00" readonly style="background:#f5f5f5; color:#999;">
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">接收地址</label>
                        <input type="text" class="form-input" id="buyAddress" placeholder="输入钱包地址">
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">选择支付方式</label>
                        <button class="payment-method-btn" onclick="openPaymentMethodModal()">
                            <span id="selectedPaymentMethod">选择支付方式</span>
                            <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                        </button>
                    </div>

                    <button class="action-btn btn-active" onclick="executeBuy()">购买</button>
                </div>
                
                <div class="sell-form" id="sellFormContent" style="display:none;">
                    <div class="form-group">
                        <label class="form-group-label">选择代币</label>
                        <div class="token-select-btn" onclick="openSellTokenModal()">
                            <div style="display:flex; align-items:center; gap:8px;">
                                <img id="sellTokenIcon" src="https://cryptologos.cc/logos/tether-usdt-logo.png" style="width:24px; height:24px; border-radius:50%;">
                                <span id="sellTokenName">USDT</span>
                            </div>
                            <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">卖出金额</label>
                        <input type="number" class="form-input" id="sellAmount" placeholder="输入卖出数量" oninput="calculateSellAmount()">
                        <div class="balance-row" style="margin-top:8px;">
                            <span>余额: <span id="sellBalance">100.00</span></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">接收金额</label>
                        <input type="text" class="form-input" id="sellReceiveAmount" placeholder="0.00" readonly style="background:#f5f5f5; color:#999;">
                    </div>

                    <div class="form-group">
                        <label class="form-group-label">通道 / 出金方式</label>
                        <button class="payment-method-btn" onclick="openChannelModal()">
                            <span id="selectedChannel">选择通道</span>
                            <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                        </button>
                    </div>

                    <button class="action-btn btn-active" onclick="executeSell()">卖出</button>
                </div>
            </div>
        </div>

        <div style="display:flex; gap:15px; margin-top:20px;">
            <div style="flex:1; background:white; padding:15px; border-radius:16px; display:flex; align-items:center; gap:10px;">
                <img src="https://cryptologos.cc/logos/bitcoin-btc-logo.png" width="30">
                <div>
                    <div style="font-weight:700;">BTC</div>
                    <div style="font-size:12px; color:#0f0;">+2.51%</div>
                </div>
            </div>
            <div style="flex:1; background:white; padding:15px; border-radius:16px; display:flex; align-items:center; gap:10px;">
                <img src="https://cryptologos.cc/logos/ethereum-eth-logo.png" width="30">
                <div>
                    <div style="font-weight:700;">ETH</div>
                    <div style="font-size:12px; color:#0f0;">+1.73%</div>
                </div>
            </div>
        </div>

        <!-- 更多热门代币轮播 -->
        <div style="margin-top:15px;">
            <div style="font-size:14px; font-weight:700; margin-bottom:10px; color:#666;">热门代币</div>
            <div style="display:flex; gap:10px; overflow-x:auto; padding-bottom:10px;">
                <div style="flex:0 0 auto; background:white; padding:12px; border-radius:12px; display:flex; align-items:center; gap:8px; min-width:100px;">
                    <img src="https://cryptologos.cc/logos/solana-sol-logo.png" width="24">
                    <div><div style="font-weight:700; font-size:14px;">SOL</div><div style="font-size:11px; color:#0f0;">+3.2%</div></div>
                </div>
                <div style="flex:0 0 auto; background:white; padding:12px; border-radius:12px; display:flex; align-items:center; gap:8px; min-width:100px;">
                    <img src="https://cryptologos.cc/logos/xrp-xrp-logo.png" width="24">
                    <div><div style="font-weight:700; font-size:14px;">XRP</div><div style="font-size:11px; color:#f00;">-1.5%</div></div>
                </div>
                <div style="flex:0 0 auto; background:white; padding:12px; border-radius:12px; display:flex; align-items:center; gap:8px; min-width:100px;">
                    <img src="https://assets.coingecko.com/coins/images/825/large/bnb-icon2_2x.png?1644979850" width="24">
                    <div><div style="font-weight:700; font-size:14px;">NBN</div><div style="font-size:11px; color:#0f0;">+2.1%</div></div>
                </div>
                <div style="flex:0 0 auto; background:white; padding:12px; border-radius:12px; display:flex; align-items:center; gap:8px; min-width:100px;">
                    <img src="https://coin-images.coingecko.com/coins/images/9956/large/Badge_Dai.png?1696509996" width="24">
                    <div><div style="font-weight:700; font-size:14px;">DAI</div><div style="font-size:11px; color:#f00;">-0.8%</div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 连接钱包提供商弹窗 -->
    <div class="modal-overlay" id="walletConnectModal" onclick="closeWalletModal(event, 'walletConnectModal')">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-title">选择钱包 <span class="close-modal" onclick="closeThisWalletModal('walletConnectModal')">&times;</span></div>
            
            <!-- 调用 WalletManager.connectMetamask() -->
            <div class="option-item" onclick="WalletManager.connectMetamask()">
                <img src="https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg" alt="Metamask">
                <span>MetaMask</span>
            </div>
            
            <!-- 调用 WalletManager.connectBitget() -->
            <div class="option-item" onclick="WalletManager.connectBitget()">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAMAAACfWMssAAAAgVBMVEUA8P////8AAAAA7/8A8/8A9/8AiYwAiI8A9f8AX2R19P8A6vb3/v8A6/kALzMAydTs/f8A5PIAT1QAKSlH8v+x+f+F9v/j/f8AHiEAFxgASk6Y9//O+/+5+f9Z8/+m+P8AO0AAIyIAIRwA1uEApKsAQkYANjcAVlsAm6EAsrvZ/P83Q69tAAACWUlEQVRIiZWWC3ObMAyAxeyu1EBKG4es5dXuQbb8/x84Y2MZGYukuutdyvnLp8jCFmSJKLtRabCh1diVqTWwfXQahIAQ5p+hvw3WilAIN7GWgmWToBa22QFPLDaT0HHgsMfNqEqC9T5lSV1vwTPRyQcMitYxSLn85RFDUmtNwTri3r75eIlAURIQKPfDY8ci4kwvrcGB8R22nK8tbPZv3zeTnQdLyqHvI8mZ8GCzeiaDbwKGE60D1zshK+Q+KoZzlQUiXPneJctZpQGDUBaB4/L0vxJWJZXFp+ded3xgCwthD2V1vCdPGyoD3AtZ/fTc5RZncoXOg8G35JmnXxCX6xnGBZS/Ql/n9sHv7z62hRI9KPyJr9hpbgeraadUDWj8LN9pb8viD18stfosg/PTkRDIOFsNhAzOyjkn3knJ2CmQnPjWpaR3Hu5o+nnhwwVr65wVkhP3ei5oIBfnkSbhYoAhJoPT78qBfpUNRTbERY7k25JtcOKiFhIXTY699tc1bYHd+C93S0zLXRM3DXZ3HiWPx7OoIdty8dc8Ife8CEGsX2SOC75nfMEaA/b7t+Lah5y4zofV133usCLn8V0+ECcLlnyueZKzd8D813Ikk+csdLfVl/JcbkgLdkkl45tLiherSrUP47N3FV7lessxPhjIDLCprOQ4HY0r0XgkHy9PLi6U80NHGJAiMpz/5LzQOESGkazUN0Y5oxtwNRkC+Zlz4dosDWYd7KBCXzMOzLIxNR9bDE50ZTxal2PKusGSw3ynYO0VZiA/b1clQBN13yp7pAyq7evkkv/22h/zGqVCbgAAAABJRU5ErkJggg==" alt="Bitget">
                <span>Bitget Wallet</span>
            </div>
            
            <!-- 调用 WalletManager.mockConnect() -->
            <div class="option-item" onclick="WalletManager.mockConnect('OKX Wallet')">
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJDSURBVHgB7Zq9jtpAEMfHlhEgQLiioXEkoAGECwoKxMcTRHmC5E3IoyRPkPAEkI7unJYmTgEFTYwA8a3NTKScLnCHN6c9r1e3P2llWQy7M/s1Gv1twCP0ej37dDq9x+Zut1t3t9vZjDEHIiSRSPg4ZpDL5fxkMvn1cDh8m0wmfugfO53OoFQq/crn8wxfY9EymQyrVCqMfHvScZx1p9ls3pFxXBy/bKlUipGPrVbLuQqAfsCliq3zl0H84zwtjQrOw4Mt1W63P5LvBm2d+Xz+YzqdgkqUy+WgWCy+Mc/nc282m4FqLBYL+3g8fjDxenq72WxANZbLJeA13zDX67UDioL5ybXwafMYu64Ltn3bdDoeQ5R97fd7GyhBQMipx4POeEDHIu2LfDdBIGGz+hJ9CQ1ABjoA2egAZPM6AgiCAEQhsi/C4jHyPA/6/f5NG3Ks2+3AYDC4aTccDrn6ojG54MnEvG00GoVmWLIRNZ7wTCwDHYBsdACy0QHIhiuRETxlICWpMMhGZHmqS8qH6JLyGegAZKMDkI0uKf8X4SWlaZo+Pp1bRrwlJU8ZKLIvUjKh0WiQ3sRUbNVq9c5Ebew7KEo2m/1p4jJ4qAmDaqDQBzj5XyiAT4VCQezJigAU+IDU+z8vJFnGWeC+bKQV/5VZ71FV6L7PA3gg3tXrdQ+DgLhC+75Wq3no69P3MC0NFQpx2lL04Ql9gHK1bRDjsSBIvScBnDTk1WrlGIZBorIDEYJj+rhdgnQ67VmWRe0zlplXl81vcyEt0rSoYDUAAAAASUVORK5CYII=" alt="TP">
                <span>OKX Wallet</span>
            </div>
             <div class="option-item" onclick="WalletManager.mockConnect('TokenPocket')">
                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8ZyBtYXNrPSJ1cmwoI21hc2swXzQwOF8yMjUpIj4KPHBhdGggZD0iTTEwNDEuNTIgMEgtMjdWMTAyNEgxMDQxLjUyVjBaIiBmaWxsPSIjMjk4MEZFIi8+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF80MDhfMjI1KSI+CjxwYXRoIGQ9Ik00MDYuNzk2IDQzOC42NDNINDA2LjkyN0M0MDYuNzk2IDQzNy44NTcgNDA2Ljc5NiA0MzYuOTQgNDA2Ljc5NiA0MzYuMTU0VjQzOC42NDNaIiBmaWxsPSIjMjlBRUZGIi8+CjxwYXRoIGQ9Ik02NjcuNjAyIDQ2My41MzNINTIzLjI0OVY3MjQuMDc2QzUyMy4yNDkgNzM2LjM4OSA1MzMuMjA0IDc0Ni4zNDUgNTQ1LjUxNyA3NDYuMzQ1SDY0NS4zMzNDNjU3LjY0NyA3NDYuMzQ1IDY2Ny42MDIgNzM2LjM4OSA2NjcuNjAyIDcyNC4wNzZWNDYzLjUzM1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik00NTMuNTYzIDI3N0g0NDguNzE2SDE5MC4yNjlDMTc3Ljk1NSAyNzcgMTY4IDI4Ni45NTUgMTY4IDI5OS4yNjlWMzg5LjY1M0MxNjggNDAxLjk2NyAxNzcuOTU1IDQxMS45MjIgMTkwLjI2OSA0MTEuOTIySDI1MC45MThIMjc1LjAyMVY0MzguNjQ0VjcyNC43MzFDMjc1LjAyMSA3MzcuMDQ1IDI4NC45NzYgNzQ3IDI5Ny4yODkgNzQ3SDM5Mi4xMjhDNDA0LjQ0MSA3NDcgNDE0LjM5NiA3MzcuMDQ1IDQxNC4zOTYgNzI0LjczMVY0MzguNjQ0VjQzNi4xNTZWNDExLjkyMkg0MzguNDk5SDQ0OC4zMjNINDUzLjE3QzQ5MC4zNzIgNDExLjkyMiA1MjAuNjMxIDM4MS42NjMgNTIwLjYzMSAzNDQuNDYxQzUyMS4wMjQgMzA3LjI1OSA0OTAuNzY1IDI3NyA0NTMuNTYzIDI3N1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik02NjcuNzM1IDQ2My41MzNWNjQ1LjM1QzY3Mi43MTMgNjQ2LjUyOSA2NzcuODIxIDY0Ny40NDYgNjgzLjA2MSA2NDguMjMyQzY5MC4zOTcgNjQ5LjI4IDY5Ny45OTQgNjQ5LjkzNSA3MDUuNTkyIDY1MC4wNjZDNzA1Ljk4NSA2NTAuMDY2IDcwNi4zNzggNjUwLjA2NiA3MDYuOTAyIDY1MC4wNjZWNTA1LjQ1QzY4NS4wMjYgNTA0LjAwOSA2NjcuNzM1IDQ4NS44MDEgNjY3LjczNSA0NjMuNTMzWiIgZmlsbD0idXJsKCNwYWludDBfbGluZWFyXzQwOF8yMjUpIi8+CjxwYXRoIGQ9Ik03MDkuNzgxIDI3N0M2MDYuODIyIDI3NyA1MjMuMjQ5IDM2MC41NzMgNTIzLjI0OSA0NjMuNTMzQzUyMy4yNDkgNTUyLjA4NCA1ODQuOTQ2IDYyNi4yMjUgNjY3LjczMyA2NDUuMzVWNDYzLjUzM0M2NjcuNzMzIDQ0MC4zNDcgNjg2LjU5NiA0MjEuNDg0IDcwOS43ODEgNDIxLjQ4NEM3MzIuOTY3IDQyMS40ODQgNzUxLjgzIDQ0MC4zNDcgNzUxLjgzIDQ2My41MzNDNzUxLjgzIDQ4My4wNTEgNzM4LjYgNDk5LjQyNSA3MjAuNTIzIDUwNC4xNEM3MTcuMTE3IDUwNS4wNTcgNzEzLjQ0OSA1MDUuNTgxIDcwOS43ODEgNTA1LjU4MVY2NTAuMDY2QzcxMy40NDkgNjUwLjA2NiA3MTYuOTg2IDY0OS45MzUgNzIwLjUyMyA2NDkuODA0QzgxOC41MDUgNjQ0LjE3MSA4OTYuMzE0IDU2Mi45NTYgODk2LjMxNCA0NjMuNTMzQzg5Ni40NDUgMzYwLjU7MyA4MTIuODcyIDI3NyA3MDkuNzgxIDI3N1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik03MDkuNzggNjUwLjA2NlY1MDUuNTgxQzcwOC43MzMgNTA1LjU4MSA3MDcuODE2IDUwNS41ODEgNzA2Ljc2OCA1MDUuNDVWNjUwLjA2NkM3MDcuODE2IDY1MC4wNjYgNzA4Ljg2NCA2NTAuMDY2IDcwOS43OCA2NTAuMDY2WiIgZmlsbD0id2hpdGUiLz4KPC9nPgo8L2c+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfNDA4XzIyNSIgeDE9IjcwOS44NDQiIHkxPSI1NTYuODI3IiB4Mj0iNjY3Ljc1MyIgeTI9IjU1Ni44MjciIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KPHN0b3Agc3RvcC1jb2xvcj0id2hpdGUiLz4KPHN0b3Agb2Zmc2V0PSIwLjk2NjciIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAuMzIzMyIvPgo8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IndoaXRlIiBzdG9wLW9wYWNpdHk9IjAuMyIvPgo8L2xpbmVhckdyYWRpZW50Pgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzQwOF8yMjUiPgo8cmVjdCB3aWR0aD0iNzI4LjQ0OCIgaGVpZ2h0PSI0NzAiIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNjggMjc3KSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPgo=" alt="WC">
                <span>TokenPocket</span>
            </div>

        </div>
    </div>

    <!-- 引入钱包管理脚本 -->
    <script src="wallet.js"></script>

       <nav class="bottom-nav">
        <a href="Home.html" class="nav-item ">
            <i class="fas fa-wallet"></i>
            <span>钱包</span>
        </a>
        <a href="Discover.html" class="nav-item">
            <i class="fas fa-compass"></i>
            <span>发现</span>
        </a>
        <a href="RWA.html" class="nav-item">
            <i class="fas fa-chart-line"></i>
            <span>RWA</span>
        </a>
        <a href="Futures.html" class="nav-item">
            <i class="fas fa-chart-bar"></i>
            <span>合约</span>
        </a>
        <a href="Swap.html" class="nav-item active">
            <i class="fas fa-exchange-alt"></i>
            <span>兑换</span>
        </a>
        <a href="Invite.html" class="nav-item">
            <i class="fas fa-user-plus"></i>
            <span>邀请</span>
        </a>
    </div>

    <div class="modal-overlay" id="tokenModal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择链和代币</span>
                <span class="close-btn" onclick="document.getElementById('tokenModal').classList.remove('active')">&times;</span>
            </div>
            <div style="padding: 10px 20px;">
                <input type="text" placeholder="按代币或地址搜索" style="width:100%; padding:10px; background:#f5f5f5; border:none; border-radius:8px; outline:none;">
            </div>
            <div class="modal-body">
                <div class="token-column" id="tokenListContainer">
                    </div>

                <div class="chain-column" id="chainListContainer">
                    </div>
            </div>
        </div>
    </div>

    <!-- 购买选择代币弹窗 -->
    <div class="modal-overlay" id="buyTokenModal" onclick="closeBuyTokenModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择要购买的代币</span>
                <span class="close-btn" onclick="document.getElementById('buyTokenModal').classList.remove('active')">&times;</span>
            </div>
            <div style="padding: 10px 20px;">
                <input type="text" placeholder="搜索代币" style="width:100%; padding:10px; background:#f5f5f5; border:none; border-radius:8px; outline:none;">
            </div>
            <div class="modal-body" style="flex-direction:column;">
                <div class="token-column" id="buyTokenListContainer"></div>
            </div>
        </div>
    </div>

    <!-- 卖出选择代币弹窗 -->
    <div class="modal-overlay" id="sellTokenModal" onclick="closeSellTokenModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择要卖出的代币</span>
                <span class="close-btn" onclick="document.getElementById('sellTokenModal').classList.remove('active')">&times;</span>
            </div>
            <div style="padding: 10px 20px;">
                <input type="text" placeholder="搜索代币" style="width:100%; padding:10px; background:#f5f5f5; border:none; border-radius:8px; outline:none;">
            </div>
            <div class="modal-body" style="flex-direction:column;">
                <div class="token-column" id="sellTokenListContainer"></div>
            </div>
        </div>
    </div>

    <!-- 支付方式弹窗 -->
    <div class="modal-overlay" id="paymentMethodModal" onclick="closePaymentMethodModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择支付方式</span>
                <span class="close-btn" onclick="document.getElementById('paymentMethodModal').classList.remove('active')">&times;</span>
            </div>
            <div class="modal-body" style="flex-direction:column; padding:20px;">
                <div id="paymentMethodList"></div>
            </div>
        </div>
    </div>

    <!-- 通道 / 出金方式弹窗 -->
    <div class="modal-overlay" id="channelModal" onclick="closeChannelModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择出金通道</span>
                <span class="close-btn" onclick="document.getElementById('channelModal').classList.remove('active')">&times;</span>
            </div>
            <div class="modal-body" style="flex-direction:column; padding:20px;">
                <div id="channelList"></div>
            </div>
        </div>
    </div>

    <!-- 滑点设置菜单 -->
    <div class="slippage-overlay" id="slippageOverlay" onclick="toggleSlippageMenu()"></div>
    <div class="slippage-menu" id="slippageMenu">
        <div class="slippage-menu-header">
            <span>滑点设置</span>
            <i class="fas fa-times" onclick="toggleSlippageMenu()" style="cursor:pointer;"></i>
        </div>
        <div>
            <div class="slippage-option">
                <input type="radio" id="slippage-auto" name="slippage" value="auto" checked>
                <label for="slippage-auto">自动 (推荐)</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-01" name="slippage" value="0.1">
                <label for="slippage-01">0.1%</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-05" name="slippage" value="0.5">
                <label for="slippage-05">0.5%</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-1" name="slippage" value="1">
                <label for="slippage-1">1%</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-5" name="slippage" value="5">
                <label for="slippage-5">5%</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-10" name="slippage" value="10">
                <label for="slippage-10">10%</label>
            </div>
            <div class="slippage-option">
                <input type="radio" id="slippage-custom" name="slippage" value="custom">
                <label for="slippage-custom">自定义</label>
                <div class="slippage-custom">
                    <input type="number" id="customSlippage" placeholder="%" min="0" max="100" step="0.1">
                </div>
            </div>
        </div>
    </div>

    <!-- 流动性池创建模态框 -->
    <div class="modal-overlay" id="liquidityCreatorModal" onclick="closeLiquidityCreator(event)">
        <div class="modal-content" onclick="event.stopPropagation()" style="height:auto; max-height:90vh;">
            <div class="modal-header">
                <span class="modal-title">创建流动性池</span>
                <span class="close-btn" onclick="closeLiquidityCreator()">&times;</span>
            </div>
            
            <!-- 版本选择 -->
            <div style="padding:20px; border-bottom:1px solid #f0f0f0;">
                <div style="font-size:14px; font-weight:600; margin-bottom:10px; color:#666;">流动性池版本</div>
                <div style="display:flex; gap:10px;">
                    <button id="creatorV2Btn" onclick="setCreatorVersion('v2')" style="flex:1; padding:10px; background:#000; color:white; border:none; border-radius:12px; font-weight:600; cursor:pointer;">V2</button>
                    <button id="creatorV3Btn" onclick="setCreatorVersion('v3')" style="flex:1; padding:10px; background:white; color:#000; border:1px solid #e0e0e0; border-radius:12px; font-weight:600; cursor:pointer;">V3</button>
                </div>
            </div>

            <!-- 创建表单 -->
            <div style="padding:20px; overflow-y:auto;">
                <!-- 第一个代币选择 -->
                <div class="form-group">
                    <label class="form-group-label">选择代币对</label>
                    <div style="display:flex; gap:10px;">
                        <div style="flex:1;">
                            <div class="token-select-btn" onclick="openLiquidityTokenModal('token1')">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <img id="liquidityToken1Icon" src="https://cryptologos.cc/logos/ethereum-eth-logo.png" style="width:24px; height:24px; border-radius:50%;">
                                    <span id="liquidityToken1Symbol">ETH</span>
                                </div>
                                <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                            </div>
                        </div>
                        <div style="flex:1;">
                            <div class="token-select-btn" onclick="openLiquidityTokenModal('token2')">
                                <div style="display:flex; align-items:center; gap:8px;">
                                    <img id="liquidityToken2Icon" src="https://cryptologos.cc/logos/tether-usdt-logo.png" style="width:24px; height:24px; border-radius:50%;">
                                    <span id="liquidityToken2Symbol">USDT</span>
                                </div>
                                <i class="fas fa-chevron-down" style="font-size:12px; color:#999;"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 第一个代币数量 -->
                <div class="form-group">
                    <label class="form-group-label" id="token1DepositLabel">存款ETH数额</label>
                    <input type="number" class="form-input" id="token1Amount" placeholder="0.00" oninput="updateLiquidityPreview()" style="margin-top:8px;">
                    <div class="balance-row" style="margin-top:8px; justify-content:flex-start;">
                        <span>余额: <span id="liquidityToken1Balance">1.50</span></span>
                    </div>
                </div>

                <!-- 第二个代币数量 -->
                <div class="form-group">
                    <label class="form-group-label" id="token2DepositLabel">存款USDT数额</label>
                    <input type="number" class="form-input" id="token2Amount" placeholder="0.00" oninput="updateLiquidityPreview()" style="margin-top:8px;">
                    <div class="balance-row" style="margin-top:8px; justify-content:flex-start;">
                        <span>余额: <span id="liquidityToken2Balance">0.00</span></span>
                    </div>
                </div>

                <!-- V3 费用等级选择 -->
                <div id="v3FeeSection" style="display:none;">
                    <div class="form-group">
                        <label class="form-group-label">费用等级</label>
                        <div style="display:flex; gap:10px; margin-top:8px;">
                            <div style="flex:1; padding:12px; background:#f9f9f9; border-radius:12px; border:1px solid #e0e0e0; text-align:center; cursor:pointer;" onclick="setFeeLevel(0.05)">
                                <div style="font-size:16px; font-weight:600; color:#FF6B6B;">0.05%</div>
                                <div style="font-size:12px; color:#999; margin-top:4px;">最佳稳定性</div>
                            </div>
                            <div style="flex:1; padding:12px; background:#f9f9f9; border-radius:12px; border:1px solid #e0e0e0; text-align:center; cursor:pointer;" onclick="setFeeLevel(0.3)">
                                <div style="font-size:16px; font-weight:600; color:#FF6B6B;">0.3%</div>
                                <div style="font-size:12px; color:#999; margin-top:4px;">最常见</div>
                            </div>
                            <div style="flex:1; padding:12px; background:#f9f9f9; border-radius:12px; border:1px solid #e0e0e0; text-align:center; cursor:pointer;" onclick="setFeeLevel(1)">
                                <div style="font-size:16px; font-weight:600; color:#FF6B6B;">1%</div>
                                <div style="font-size:12px; color:#999; margin-top:4px;">高波动性</div>
                            </div>
                        </div>
                    </div>

                    <!-- 价格范围 -->
                    <div class="form-group">
                        <label class="form-group-label">价格范围</label>
                        <div style="display:flex; gap:10px; margin-top:8px;">
                            <div style="flex:1;">
                                <label style="font-size:12px; color:#999;">最低价格</label>
                                <input type="number" class="form-input" id="priceLow" placeholder="0.00" oninput="updateLiquidityPreview()" style="margin-top:4px;">
                            </div>
                            <div style="flex:1;">
                                <label style="font-size:12px; color:#999;">最高价格</label>
                                <input type="number" class="form-input" id="priceHigh" placeholder="0.00" oninput="updateLiquidityPreview()" style="margin-top:4px;">
                            </div>
                        </div>
                    </div>

                    <!-- 价格范围快速选择 -->
                    <div class="form-group">
                        <label class="form-group-label">快速设置范围</label>
                        <div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
                            <button onclick="setPriceRange(0.9, 1.1)" style="flex:1; min-width:60px; padding:8px 12px; background:#f9f9f9; border:1px solid #e0e0e0; border-radius:8px; font-size:12px; cursor:pointer;">±10%</button>
                            <button onclick="setPriceRange(0.8, 1.2)" style="flex:1; min-width:60px; padding:8px 12px; background:#f9f9f9; border:1px solid #e0e0e0; border-radius:8px; font-size:12px; cursor:pointer;">±20%</button>
                            <button onclick="setPriceRange(0.5, 1.5)" style="flex:1; min-width:60px; padding:8px 12px; background:#f9f9f9; border:1px solid #e0e0e0; border-radius:8px; font-size:12px; cursor:pointer;">±50%</button>
                            <button onclick="setPriceRange(0, 999999)" style="flex:1; min-width:60px; padding:8px 12px; background:#f9f9f9; border:1px solid #e0e0e0; border-radius:8px; font-size:12px; cursor:pointer;">全范围</button>
                        </div>
                    </div>
                </div>

                <!-- 提交按钮 -->
                <button class="action-btn btn-active" onclick="createLiquidity()" style="margin-top:20px;">创建</button>
            </div>
        </div>
    </div>

    <!-- 流动性池代币选择弹窗 -->
    <div class="modal-overlay" id="liquidityTokenModal" onclick="closeLiquidityTokenModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <span class="modal-title">选择代币</span>
                <span class="close-btn" onclick="closeLiquidityTokenModal()">&times;</span>
            </div>
            <div style="padding: 10px 20px;">
                <input type="text" placeholder="搜索代币" style="width:100%; padding:10px; background:#f5f5f5; border:none; border-radius:8px; outline:none;">
            </div>
            <div class="modal-body" style="flex-direction:column;">
                <div class="token-column" id="liquidityTokenListContainer"></div>
            </div>
        </div>
    </div>

    <script>
        // --- 模拟数据 ---
        const chains = [
            { id: 'eth', name: 'Ethereum', icon: 'https://cryptologos.cc/logos/ethereum-eth-logo.png' },
            { id: 'bsc', name: 'BSC', icon: 'https://cryptologos.cc/logos/bnb-bnb-logo.png' },
            { id: 'arb', name: 'Arbitrum', icon: 'https://cryptologos.cc/logos/arbitrum-arb-logo.png' },
            { id: 'poly', name: 'Polygon', icon: 'https://cryptologos.cc/logos/polygon-matic-logo.png' },
            { id: 'opt', name: 'Optimism', icon: 'https://cryptologos.cc/logos/optimism-ethereum-op-logo.png' },
            { id: 'avax', name: 'Avalanche', icon: 'https://cryptologos.cc/logos/avalanche-avax-logo.png' }
        ];

        // 所有代币数据 (包括购买/卖出用的代币)
        const tokens = [
            { sym: 'ETH', name: 'Ethereum', icon: 'https://cryptologos.cc/logos/ethereum-eth-logo.png', chain: 'eth', price: 3200 },
            { sym: 'USDT', name: 'Tether USD', icon: 'https://cryptologos.cc/logos/tether-usdt-logo.png', chain: 'all', price: 1 },
            { sym: 'USDC', name: 'USD Coin', icon: 'https://cryptologos.cc/logos/usd-coin-usdc-logo.png', chain: 'all', price: 1 },
            { sym: 'USDH', name: 'Huobi Dollar', icon: 'data:image/png;base64,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', chain: 'all', price: 1 },
            { sym: 'UNI', name: 'Uniswap', icon: 'https://cryptologos.cc/logos/uniswap-uni-logo.png', chain: 'eth', price: 6 },
            { sym: 'BNB', name: 'BNB', icon: 'https://cryptologos.cc/logos/bnb-bnb-logo.png', chain: 'bsc', price: 600 },
            { sym: 'CAKE', name: 'PancakeSwap', icon: 'https://cryptologos.cc/logos/pancakeswap-cake-logo.png', chain: 'bsc', price: 2.5 },
            { sym: 'ARB', name: 'Arbitrum', icon: 'https://cryptologos.cc/logos/arbitrum-arb-logo.png', chain: 'arb', price: 1.2 },
            { sym: 'BTC', name: 'Bitcoin', icon: 'https://cryptologos.cc/logos/bitcoin-btc-logo.png', chain: 'all', price: 92440 },
            { sym: 'SOL', name: 'Solana', icon: 'https://cryptologos.cc/logos/solana-sol-logo.png', chain: 'all', price: 220 },
            { sym: 'XRP', name: 'XRP', icon: 'https://cryptologos.cc/logos/xrp-xrp-logo.png', chain: 'all', price: 3.5 },
            { sym: 'SEI', name: 'Tesla Token', icon: 'https://assets.coingecko.com/coins/images/54862/thumb/sei.jpg?1742182276', chain: 'all', price: 410 },
            { sym: 'ADS', name: 'Luna', icon: 'https://assets.coingecko.com/coins/images/17979/thumb/ADS.png?1706546465', chain: 'all', price: 125 }
        ];

        // 支付方式
        const paymentMethods = [
            { id: 'usd', name: '美元 (USD)', flag: '🇺🇸' },
            { id: 'riel', name: '瑞尔 (KHR)', flag: '🇰🇭' },
            { id: 'baht', name: '泰铢 (THB)', flag: '🇹🇭' },
            { id: 'ringgit', name: '马来西亚币 (MYR)', flag: '🇲🇾' }
        ];

        // 出金通道
        const channels = [
            { id: 'bank_usd', name: '银行转账 - USD', currency: 'USD' },
            { id: 'bank_riel', name: '银行转账 - KHR', currency: 'KHR' },
            { id: 'bank_baht', name: '银行转账 - THB', currency: 'THB' },
            { id: 'bank_ringgit', name: '银行转账 - MYR', currency: 'MYR' }
        ];

        // --- 状态 ---
        let state = {
            currentMode: 'swap', // 'swap', 'liquidity', 'otc'
            currentOTCMode: 'buy', // 'buy' 或 'sell' (仅在 OTC 模式下使用)
            currentTokenMode: 'pay', // 用于兑换页面
            currentChainMode: 'from', // 用于标识当前选择的是'from'还是'to'网络
            payToken: tokens[0],
            receiveToken: tokens[1],
            payBalance: 1.5,
            receiveBalance: 0.0,
            selectedChainFilter: 'eth',
            fromChain: 'eth',  // 用于"从"网络显示
            toChain: 'eth',    // 用于"到"网络显示
            buyToken: tokens[1], // USDT
            sellToken: tokens[1], // USDT
            selectedPaymentMethod: null,
            selectedChannel: null,
            selectedSlippage: 'auto'
        };

        // --- 流动性池数据 ---
        let liquidityState = {
            currentVersion: 'v2', // 'v2' 或 'v3'
            creatorVersion: 'v2',
            selectedTokenMode: null,
            token1: tokens[0], // ETH
            token2: tokens[1], // USDT
            showOnlyMyPositions: false,
            feeLevel: 0.3,
            currentPrice: 3200, // ETH/USDT 价格
            liquidityPools: [
                { id: 1, token1: tokens[1], token2: tokens[5], version: 'v2', liquidity: '1200000', tvl: '$31,180,009', myShare: '$163M', fee: 0.01, dailyVolume: '$100M', apr: 25.82 },
                { id: 2, token1: tokens[1], token2: tokens[2], version: 'v2', liquidity: '900000', tvl: '$21,523,926', myShare: '$32,264,331', fee: 0.05, dailyVolume: '$120M', apr: 29.32 },
                { id: 3, token1: tokens[1], token2: tokens[3], version: 'v2', liquidity: '750000', tvl: '$3,767,909', myShare: '$48,262,482', fee: 0.01, dailyVolume: '$85M', apr: 48.62 },
                { id: 4, token1: tokens[5], token2: tokens[11], version: 'v2', liquidity: '650000', tvl: '$2,870,493.9', myShare: '$30,797,048', fee: 0.01, dailyVolume: '$95M', apr: 40.91 },
                { id: 5, token1: tokens[1], token2: tokens[10], version: 'v2', liquidity: '800000', tvl: '$6,926,098.1', myShare: '$47,161,436', fee: 0.01, dailyVolume: '$110M', apr: 24.97 },
                { id: 6, token1: tokens[1], token2: tokens[9], version: 'v2', liquidity: '550000', tvl: '$100M', myShare: '$8,065,966.2', fee: 0.25, dailyVolume: '$75M', apr: 5.00 },
                { id: 7, token1: tokens[1], token2: tokens[8], version: 'v2', liquidity: '1100000', tvl: '$26,762,922', myShare: '$3,323,286.7', fee: 0.01, dailyVolume: '$130M', apr: 0.60 },
                { id: 8, token1: tokens[1], token2: tokens[12], version: 'v2', liquidity: '950000', tvl: '$156M', myShare: '$14,411,271', fee: 0.01, dailyVolume: '$105M', apr: 0.33 },
            ]
        };

        // --- 初始化 ---
        window.onload = function() {
            renderChains();
            renderTokens('eth');
            renderBuyTokenList();
            renderSellTokenList();
            renderPaymentMethodList();
            renderChannelList();
            renderLiquidityTokenList();
            renderLiquidityList();
            updateUI();
        };

        // --- 页面模式切换 ---
        function switchMode(mode) {
            state.currentMode = mode;
            const swapMode = document.getElementById('swapMode');
            const liquidityMode = document.getElementById('liquidityMode');
            const otcMode = document.getElementById('otcMode');
            
            swapMode.style.display = mode === 'swap' ? 'block' : 'none';
            liquidityMode.style.display = mode === 'liquidity' ? 'block' : 'none';
            otcMode.style.display = mode === 'otc' ? 'block' : 'none';
            
            // 更新顶部导航栏的激活状态
            const navTabs = document.querySelectorAll('.swap-container > div:first-child > div');
            if (navTabs.length >= 3) {
                navTabs[0].style.borderBottom = mode === 'swap' ? '2px solid #000' : 'none';
                navTabs[0].style.color = mode === 'swap' ? '#000' : '#999';
                navTabs[1].style.borderBottom = mode === 'liquidity' ? '2px solid #000' : 'none';
                navTabs[1].style.color = mode === 'liquidity' ? '#000' : '#999';
                navTabs[2].style.borderBottom = mode === 'otc' ? '2px solid #000' : 'none';
                navTabs[2].style.color = mode === 'otc' ? '#000' : '#999';
            }
        }
        
        // --- OTC 模式切换（购买/卖出）---
        function switchOTCMode(mode) {
            state.currentOTCMode = mode;
            const buyBtn = document.getElementById('buyBtn');
            const sellBtn = document.getElementById('sellBtn');
            const buyFormContent = document.getElementById('buyFormContent');
            const sellFormContent = document.getElementById('sellFormContent');
            
            if (mode === 'buy') {
                buyBtn.style.background = '#FF6B6B';
                buyBtn.style.color = 'white';
                sellBtn.style.background = '#f0f0f0';
                sellBtn.style.color = '#000';
                buyFormContent.style.display = 'block';
                sellFormContent.style.display = 'none';
            } else {
                buyBtn.style.background = '#f0f0f0';
                buyBtn.style.color = '#000';
                sellBtn.style.background = '#FF6B6B';
                sellBtn.style.color = 'white';
                buyFormContent.style.display = 'none';
                sellFormContent.style.display = 'block';
            }
        }

        // --- 渲染逻辑 ---
        function renderChains() {
            const container = document.getElementById('chainListContainer');
            container.innerHTML = chains.map(c => `
                <div class="chain-item ${c.id === state.selectedChainFilter ? 'active' : ''}" onclick="selectChainFilter('${c.id}')">
                    <img src="${c.icon}"> ${c.name}
                </div>
            `).join('');
        }

        function renderTokens(chainId) {
            const container = document.getElementById('tokenListContainer');
            const filtered = tokens.filter(t => t.chain === 'all' || t.chain === chainId);
            container.innerHTML = `<div style="font-size:12px; color:#999; margin-bottom:10px;">热门代币</div>` + 
            filtered.map(t => `
                <div class="token-item" onclick="selectToken('${t.sym}')">
                    <img src="${t.icon}">
                    <div class="token-text">
                        <h4>${t.sym}</h4>
                        <p>${t.name}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderBuyTokenList() {
            const container = document.getElementById('buyTokenListContainer');
            const buyTokens = [tokens[1], tokens[2], tokens[3]]; // USDT, USDC, USDH
            container.innerHTML = buyTokens.map(t => `
                <div class="token-item" onclick="selectBuyToken('${t.sym}')">
                    <img src="${t.icon}">
                    <div class="token-text">
                        <h4>${t.sym}</h4>
                        <p>${t.name}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderSellTokenList() {
            const container = document.getElementById('sellTokenListContainer');
            const sellTokens = [tokens[1], tokens[2], tokens[3]]; // USDT, USDC, USDH
            container.innerHTML = sellTokens.map(t => `
                <div class="token-item" onclick="selectSellToken('${t.sym}')">
                    <img src="${t.icon}">
                    <div class="token-text">
                        <h4>${t.sym}</h4>
                        <p>${t.name}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderPaymentMethodList() {
            const container = document.getElementById('paymentMethodList');
            container.innerHTML = paymentMethods.map(m => `
                <div style="padding:15px; border:1px solid #e0e0e0; border-radius:12px; margin-bottom:10px; cursor:pointer;" onclick="selectPaymentMethod('${m.id}', '${m.name}')">
                    <div style="font-size:16px; font-weight:700;">${m.flag} ${m.name}</div>
                </div>
            `).join('');
        }

        function renderChannelList() {
            const container = document.getElementById('channelList');
            container.innerHTML = channels.map(c => `
                <div style="padding:15px; border:1px solid #e0e0e0; border-radius:12px; margin-bottom:10px; cursor:pointer;" onclick="selectChannel('${c.id}', '${c.name}')">
                    <div style="font-size:16px; font-weight:700;">${c.name}</div>
                </div>
            `).join('');
        }

        function updateUI() {
            // 更新兑换页面
            document.getElementById('payTokenSymbol').innerText = state.payToken.sym;
            document.getElementById('payTokenIcon').src = state.payToken.icon;
            document.getElementById('receiveTokenSymbol').innerText = state.receiveToken.sym;
            document.getElementById('receiveTokenIcon').src = state.receiveToken.icon;

            document.getElementById('payBalance').innerText = state.payBalance.toFixed(4);
            document.getElementById('receiveBalance').innerText = state.receiveBalance.toFixed(4);

            // 更新网络名称
            const fromChainName = chains.find(c => c.id === state.fromChain)?.name || 'Ethereum';
            const toChainName = chains.find(c => c.id === state.toChain)?.name || 'Ethereum';
            document.getElementById('fromChainText').innerText = fromChainName;
            document.getElementById('toChainText').innerText = toChainName;

            // 更新购买页面
            document.getElementById('buyTokenIcon').src = state.buyToken.icon;
            document.getElementById('buyTokenName').innerText = state.buyToken.sym;

            // 更新卖出页面
            document.getElementById('sellTokenIcon').src = state.sellToken.icon;
            document.getElementById('sellTokenName').innerText = state.sellToken.sym;
            document.getElementById('sellBalance').innerText = (Math.random() * 200).toFixed(2);

            calculateOutput();
        }

        // --- 交互逻辑 ---

        // 兑换页面 - 打开网络选择
        function openChainModal(mode) {
            state.currentChainMode = mode; // 'from' 或 'to'
            state.selectedChainFilter = mode === 'from' ? state.fromChain : state.toChain;
            renderChains();
            // 隐藏代币列表，只显示链列表
            document.getElementById('tokenListContainer').style.display = 'none';
            document.getElementById('chainListContainer').style.display = 'block';
            document.getElementById('tokenModal').classList.add('active');
        }

        // 兑换页面 - 打开代币选择
        function openTokenModal(mode) {
            state.currentTokenMode = mode;
            const currentChain = mode === 'pay' ? state.fromChain : state.toChain;
            renderTokens(currentChain);
            // 显示代币列表和链列表
            document.getElementById('tokenListContainer').style.display = 'block';
            document.getElementById('chainListContainer').style.display = 'block';
            document.getElementById('tokenModal').classList.add('active');
        }

        function closeModal(e) {
            if (e.target.id === 'tokenModal') {
                document.getElementById('tokenModal').classList.remove('active');
            }
        }

        // 购买页面 - 打开代币选择
        function openBuyTokenModal() {
            document.getElementById('buyTokenModal').classList.add('active');
        }

        function closeBuyTokenModal(e) {
            if (e.target.id === 'buyTokenModal') {
                document.getElementById('buyTokenModal').classList.remove('active');
            }
        }

        function selectBuyToken(sym) {
            state.buyToken = tokens.find(t => t.sym === sym);
            document.getElementById('buyTokenModal').classList.remove('active');
            updateUI();
        }

        // 卖出页面 - 打开代币选择
        function openSellTokenModal() {
            document.getElementById('sellTokenModal').classList.add('active');
        }

        function closeSellTokenModal(e) {
            if (e.target.id === 'sellTokenModal') {
                document.getElementById('sellTokenModal').classList.remove('active');
            }
        }

        function selectSellToken(sym) {
            state.sellToken = tokens.find(t => t.sym === sym);
            document.getElementById('sellTokenModal').classList.remove('active');
            updateUI();
        }

        // 支付方式弹窗
        function openPaymentMethodModal() {
            document.getElementById('paymentMethodModal').classList.add('active');
        }

        function closePaymentMethodModal(e) {
            if (e.target.id === 'paymentMethodModal') {
                document.getElementById('paymentMethodModal').classList.remove('active');
            }
        }

        function selectPaymentMethod(id, name) {
            state.selectedPaymentMethod = name;
            document.getElementById('selectedPaymentMethod').innerText = name;
            document.getElementById('paymentMethodModal').classList.remove('active');
        }

        // 通道弹窗
        function openChannelModal() {
            document.getElementById('channelModal').classList.add('active');
        }

        function closeChannelModal(e) {
            if (e.target.id === 'channelModal') {
                document.getElementById('channelModal').classList.remove('active');
            }
        }

        function selectChannel(id, name) {
            state.selectedChannel = name;
            document.getElementById('selectedChannel').innerText = name;
            document.getElementById('channelModal').classList.remove('active');
        }

        // 滑点菜单
        function toggleSlippageMenu() {
            const menu = document.getElementById('slippageMenu');
            const overlay = document.getElementById('slippageOverlay');
            menu.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        // 兑换页面 - 链选择
        function selectChainFilter(chainId) {
            state.selectedChainFilter = chainId;
            
            // 根据当前模式独立更新 fromChain 或 toChain
            if (state.currentChainMode === 'from') {
                state.fromChain = chainId;
                // 根据选择的链过滤代币并更新 payToken
                const availableTokens = tokens.filter(t => t.chain === 'all' || t.chain === chainId);
                if (availableTokens.length > 0 && !availableTokens.find(t => t.sym === state.payToken.sym)) {
                    state.payToken = availableTokens[0];
                }
            } else if (state.currentChainMode === 'to') {
                state.toChain = chainId;
                // 根据选择的链过滤代币并更新 receiveToken
                const availableTokens = tokens.filter(t => t.chain === 'all' || t.chain === chainId);
                if (availableTokens.length > 0 && !availableTokens.find(t => t.sym === state.receiveToken.sym)) {
                    state.receiveToken = availableTokens[0];
                }
            }
            
            renderChains();
            document.getElementById('tokenModal').classList.remove('active');
            updateUI();
        }

        // 兑换页面 - 代币选择
        function selectToken(sym) {
            const token = tokens.find(t => t.sym === sym);
            if (state.currentTokenMode === 'pay') {
                state.payToken = token;
                state.payBalance = Math.random() * 5;
            } else {
                state.receiveToken = token;
                state.receiveBalance = Math.random() * 100;
            }
            document.getElementById('tokenModal').classList.remove('active');
            updateUI();
        }

        // 点击中间箭头交换
        function switchDirection() {
            // 交换网络
            const tempChain = state.fromChain;
            state.fromChain = state.toChain;
            state.toChain = tempChain;
            
            // 交换代币
            const tempToken = state.payToken;
            state.payToken = state.receiveToken;
            state.receiveToken = tempToken;
            
            // 交换余额
            const tempBal = state.payBalance;
            state.payBalance = state.receiveBalance;
            state.receiveBalance = tempBal;

            updateUI();
        }

        // 点击最大
        function setMax() {
            document.getElementById('payInput').value = state.payBalance;
            calculateOutput();
        }

        // 计算兑换输出
        function calculateOutput() {
            const inputVal = parseFloat(document.getElementById('payInput').value);
            const btn = document.getElementById('mainBtn');

            if (!inputVal || inputVal <= 0) {
                document.getElementById('receiveInput').value = "";
                btn.innerText = "输入金额";
                btn.className = "action-btn btn-active";
                return;
            }

            if (inputVal > state.payBalance) {
                btn.innerText = `余额不足 ${state.payToken.sym}`;
                btn.className = "action-btn btn-warning";
            } else {
                btn.innerText = "兑换";
                btn.className = "action-btn btn-active";
            }

            const output = (inputVal * state.payToken.price) / state.receiveToken.price;
            document.getElementById('receiveInput').value = output.toFixed(6);
        }

        // 计算购买的USD金额
        function calculateBuyUSD() {
            const amount = parseFloat(document.getElementById('buyAmount').value);
            if (!amount || amount <= 0) {
                document.getElementById('buyUSD').value = "";
                return;
            }
            // 模拟: 数量 * 单价 / 1 (因为代币都假设USD价格)
            const usdAmount = amount * state.buyToken.price;
            document.getElementById('buyUSD').value = usdAmount.toFixed(2);
        }

        // 计算卖出获得金额
        function calculateSellAmount() {
            const amount = parseFloat(document.getElementById('sellAmount').value);
            if (!amount || amount <= 0) {
                document.getElementById('sellReceiveAmount').value = "";
                return;
            }
            // 模拟: 数量 * 单价
            const receiveAmount = amount * state.sellToken.price;
            document.getElementById('sellReceiveAmount').value = receiveAmount.toFixed(2);
        }

        // 执行兑换
        function executeSwap() {
            const btn = document.getElementById('mainBtn');
            if (btn.innerText === "兑换") {
                btn.innerText = "兑换中...";
                setTimeout(() => {
                    alert("兑换成功！");
                    document.getElementById('payInput').value = "";
                    document.getElementById('receiveInput').value = "";
                    btn.innerText = "输入金额";
                    updateUI();
                }, 1500);
            }
        }

        // 执行购买
        function executeBuy() {
            const address = document.getElementById('buyAddress').value;
            const amount = document.getElementById('buyAmount').value;
            const paymentMethod = state.selectedPaymentMethod;

            if (!address) {
                alert("请输入接收地址");
                return;
            }
            if (!amount) {
                alert("请输入购买金额");
                return;
            }
            if (!paymentMethod) {
                alert("请选择支付方式");
                return;
            }

            alert(`购买成功！\n代币: ${state.buyToken.sym}\n数量: ${amount}\n支付方式: ${paymentMethod}`);
            document.getElementById('buyAmount').value = "";
            document.getElementById('buyUSD').value = "";
            document.getElementById('buyAddress').value = "";
            document.getElementById('selectedPaymentMethod').innerText = "选择支付方式";
            state.selectedPaymentMethod = null;
        }

        // 执行卖出
        function executeSell() {
            const amount = document.getElementById('sellAmount').value;
            const channel = state.selectedChannel;

            if (!amount) {
                alert("请输入卖出金额");
                return;
            }
            if (!channel) {
                alert("请选择出金通道");
                return;
            }

            alert(`卖出成功！\n代币: ${state.sellToken.sym}\n数量: ${amount}\n出金通道: ${channel}`);
            document.getElementById('sellAmount').value = "";
            document.getElementById('sellReceiveAmount').value = "";
            document.getElementById('selectedChannel').innerText = "选择通道";
            state.selectedChannel = null;
        }
        
        
        // --- 流动性池函数 ---
        
        function renderLiquidityTokenList() {
            const container = document.getElementById('liquidityTokenListContainer');
            container.innerHTML = tokens.map(t => `
                <div class="token-item" onclick="selectLiquidityToken('${t.sym}')">
                    <img src="${t.icon}">
                    <div class="token-text">
                        <h4>${t.sym}</h4>
                        <p>${t.name}</p>
                    </div>
                </div>
            `).join('');
        }

        function renderLiquidityList() {
            const container = document.getElementById('liquidityListContainer');
            let pools = liquidityState.liquidityPools;
            
            // 筛选版本
            pools = pools.filter(p => p.version === liquidityState.currentVersion);
            
            // 筛选我的持仓
            if (liquidityState.showOnlyMyPositions) {
                pools = pools.filter(p => p.myShare && parseFloat(p.myShare.replace('$', '')) > 0);
            }
            
            // 搜索过滤
            const searchTerm = document.getElementById('liquiditySearch')?.value.toLowerCase() || '';
            if (searchTerm) {
                pools = pools.filter(p => 
                    p.token1.sym.toLowerCase().includes(searchTerm) ||
                    p.token2.sym.toLowerCase().includes(searchTerm) ||
                    `${p.token1.sym}-${p.token2.sym}`.toLowerCase().includes(searchTerm)
                );
            }

            container.innerHTML = pools.map(pool => `
                <div style="display:grid; grid-template-columns:2fr 1fr 1fr 1fr 1fr; gap:15px; align-items:center; padding:12px 0; border-bottom:1px solid #f0f0f0; font-size:14px;" class="liquidity-item">
                    <div style="display:flex; align-items:center; gap:8px;">
                        <img src="${pool.token1.icon}" style="width:32px; height:32px; border-radius:50%;">
                        <div style="display:flex; align-items:center; gap:4px; font-weight:600;">
                            <span>${pool.token1.sym}</span>
                            <span style="font-size:12px; color:#999;">-</span>
                            <span>${pool.token2.sym}</span>
                            <img src="${pool.token2.icon}" style="width:28px; height:28px; border-radius:50%; margin-left:2px;">
                            <span style="font-size:11px; background:#f0f0f0; padding:2px 6px; border-radius:4px; color:#666; margin-left:6px;">${pool.version.toUpperCase()} ${pool.fee}%</span>
                        </div>
                    </div>
                    <div style="color:#000; font-weight:600;">${pool.address || '0x...'}</div>
                    <div style="color:#000; font-weight:600;">${pool.tvl}</div>
                    <div style="color:#000; font-weight:600;">${pool.dailyVolume || '$0'}</div>
                    <div style="color:#0f0; font-weight:600;">${pool.apr?.toFixed(2) || '0.00'}%</div>
                </div>
            `).join('');
            
            if (pools.length === 0) {
                container.innerHTML = '<div style="padding:40px 20px; text-align:center; color:#999;">暂无流动性池</div>';
            }
        }

        function switchLiquidityVersion(version) {
            liquidityState.currentVersion = version;
            
            // 更新按钮状态
            const v2Btn = document.getElementById('v2Btn');
            const v3Btn = document.getElementById('v3Btn');
            
            if (version === 'v2') {
                v2Btn.style.background = '#000';
                v2Btn.style.color = 'white';
                v3Btn.style.background = 'white';
                v3Btn.style.color = '#000';
            } else {
                v2Btn.style.background = 'white';
                v2Btn.style.color = '#000';
                v3Btn.style.background = '#000';
                v3Btn.style.color = 'white';
            }
            
            renderLiquidityList();
        }

        function toggleMyPositions() {
            liquidityState.showOnlyMyPositions = document.getElementById('myPositionsCheckbox').checked;
            renderLiquidityList();
        }

        function searchLiquidity() {
            renderLiquidityList();
        }

        function openLiquidityCreator() {
            liquidityState.creatorVersion = 'v2';
            setCreatorVersion('v2');
            document.getElementById('liquidityCreatorModal').classList.add('active');
        }

        function closeLiquidityCreator(event) {
            if (event && event.target.id === 'liquidityCreatorModal') {
                document.getElementById('liquidityCreatorModal').classList.remove('active');
            } else if (!event) {
                document.getElementById('liquidityCreatorModal').classList.remove('active');
            }
        }

        function setCreatorVersion(version) {
            liquidityState.creatorVersion = version;
            const v2Btn = document.getElementById('creatorV2Btn');
            const v3Btn = document.getElementById('creatorV3Btn');
            const v3Section = document.getElementById('v3FeeSection');
            
            if (version === 'v2') {
                v2Btn.style.background = '#000';
                v2Btn.style.color = 'white';
                v3Btn.style.background = 'white';
                v3Btn.style.color = '#000';
                v3Section.style.display = 'none';
            } else {
                v2Btn.style.background = 'white';
                v2Btn.style.color = '#000';
                v3Btn.style.background = '#000';
                v3Btn.style.color = 'white';
                v3Section.style.display = 'block';
            }
        }

        function openLiquidityTokenModal(mode) {
            liquidityState.selectedTokenMode = mode;
            document.getElementById('liquidityTokenModal').classList.add('active');
        }

        function closeLiquidityTokenModal(event) {
            if (event && event.target.id === 'liquidityTokenModal') {
                document.getElementById('liquidityTokenModal').classList.remove('active');
            } else if (!event) {
                document.getElementById('liquidityTokenModal').classList.remove('active');
            }
        }

        function selectLiquidityToken(sym) {
            const token = tokens.find(t => t.sym === sym);
            if (liquidityState.selectedTokenMode === 'token1') {
                liquidityState.token1 = token;
                document.getElementById('liquidityToken1Icon').src = token.icon;
                document.getElementById('liquidityToken1Symbol').innerText = token.sym;
                document.getElementById('token1DepositLabel').innerText = `存款${token.sym}数额`;
                document.getElementById('liquidityToken1Balance').innerText = (Math.random() * 5).toFixed(4);
            } else {
                liquidityState.token2 = token;
                document.getElementById('liquidityToken2Icon').src = token.icon;
                document.getElementById('liquidityToken2Symbol').innerText = token.sym;
                document.getElementById('token2DepositLabel').innerText = `存款${token.sym}数额`;
                document.getElementById('liquidityToken2Balance').innerText = (Math.random() * 100).toFixed(4);
            }
            document.getElementById('liquidityTokenModal').classList.remove('active');
            updateLiquidityPreview();
        }

        function setFeeLevel(fee) {
            liquidityState.feeLevel = fee;
        }

        function setPriceRange(lowMultiplier, highMultiplier) {
            const lowPrice = liquidityState.currentPrice * lowMultiplier;
            const highPrice = liquidityState.currentPrice * highMultiplier;
            document.getElementById('priceLow').value = lowPrice.toFixed(2);
            document.getElementById('priceHigh').value = highPrice.toFixed(2);
            updateLiquidityPreview();
        }

        function updateLiquidityPreview() {
            const token1Amount = parseFloat(document.getElementById('token1Amount').value) || 0;
            const token2Amount = parseFloat(document.getElementById('token2Amount').value) || 0;
            
            // 这里可以添加预览计算逻辑
        }

        function createLiquidity() {
            const token1Amount = document.getElementById('token1Amount').value;
            const token2Amount = document.getElementById('token2Amount').value;
            
            if (!token1Amount || !token2Amount) {
                alert('请输入两个代币的数量');
                return;
            }
            
            const version = liquidityState.creatorVersion.toUpperCase();
            const message = `创建${version}流动性池成功！\n${liquidityState.token1.sym}: ${token1Amount}\n${liquidityState.token2.sym}: ${token2Amount}`;
            
            if (liquidityState.creatorVersion === 'v3') {
                const priceLow = document.getElementById('priceLow').value || '0.00';
                const priceHigh = document.getElementById('priceHigh').value || '0.00';
                alert(`${message}\n价格范围: ${priceLow} - ${priceHigh}\n费用等级: ${liquidityState.feeLevel}%`);
            } else {
                alert(message);
            }
            
            // 重置表单
            document.getElementById('token1Amount').value = '';
            document.getElementById('token2Amount').value = '';
            document.getElementById('priceLow').value = '';
            document.getElementById('priceHigh').value = '';
            
            closeLiquidityCreator();
            renderLiquidityList();
        }

        function manageLiquidity(poolId) {
            alert(`管理流动性池 #${poolId}`);
        }

        // 钱包弹窗控制函数
        function closeWalletModal(e, id) {
            if (e.target.id === id) {
                document.getElementById(id).style.display = 'none';
            }
        }
        function closeThisWalletModal(id) {
            document.getElementById(id).style.display = 'none';
        }

        function connectWallet() {
            document.getElementById('walletConnectModal').style.display = 'flex';
        }

    </script>
</body>
</html>